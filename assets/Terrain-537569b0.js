(function(){"use strict";const Ft=.5*(Math.sqrt(3)-1),J=(3-Math.sqrt(3))/6,St=1/3,W=1/6,Xt=(Math.sqrt(5)-1)/4,U=(5-Math.sqrt(5))/20,I=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),z=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);class xt{constructor(o=Math.random){const e=typeof o=="function"?o:vt(o);this.p=kt(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let r=0;r<512;r++)this.perm[r]=this.p[r&255],this.permMod12[r]=this.perm[r]%12}noise2D(o,e){const r=this.permMod12,M=this.perm;let l=0,g=0,A=0;const j=(o+e)*Ft,R=Math.floor(o+j),Z=Math.floor(e+j),Y=(R+Z)*J,C=R-Y,G=Z-Y,v=o-C,t=e-G;let T,N;v>t?(T=1,N=0):(T=0,N=1);const D=v-T+J,q=t-N+J,u=v-1+2*J,c=t-1+2*J,F=R&255,S=Z&255;let y=.5-v*v-t*t;if(y>=0){const s=r[F+M[S]]*3;y*=y,l=y*y*(I[s]*v+I[s+1]*t)}let X=.5-D*D-q*q;if(X>=0){const s=r[F+T+M[S+N]]*3;X*=X,g=X*X*(I[s]*D+I[s+1]*q)}let a=.5-u*u-c*c;if(a>=0){const s=r[F+1+M[S+1]]*3;a*=a,A=a*a*(I[s]*u+I[s+1]*c)}return 70*(l+g+A)}noise3D(o,e,r){const M=this.permMod12,l=this.perm;let g,A,j,R;const Z=(o+e+r)*St,Y=Math.floor(o+Z),C=Math.floor(e+Z),G=Math.floor(r+Z),v=(Y+C+G)*W,t=Y-v,T=C-v,N=G-v,D=o-t,q=e-T,u=r-N;let c,F,S,y,X,a;D>=q?q>=u?(c=1,F=0,S=0,y=1,X=1,a=0):D>=u?(c=1,F=0,S=0,y=1,X=0,a=1):(c=0,F=0,S=1,y=1,X=0,a=1):q<u?(c=0,F=0,S=1,y=0,X=1,a=1):D<u?(c=0,F=1,S=0,y=0,X=1,a=1):(c=0,F=1,S=0,y=1,X=1,a=0);const s=D-c+W,P=q-F+W,O=u-S+W,n=D-y+2*W,h=q-X+2*W,f=u-a+2*W,d=D-1+3*W,p=q-1+3*W,x=u-1+3*W,w=Y&255,b=C&255,m=G&255;let V=.6-D*D-q*q-u*u;if(V<0)g=0;else{const E=M[w+l[b+l[m]]]*3;V*=V,g=V*V*(I[E]*D+I[E+1]*q+I[E+2]*u)}let H=.6-s*s-P*P-O*O;if(H<0)A=0;else{const E=M[w+c+l[b+F+l[m+S]]]*3;H*=H,A=H*H*(I[E]*s+I[E+1]*P+I[E+2]*O)}let _=.6-n*n-h*h-f*f;if(_<0)j=0;else{const E=M[w+y+l[b+X+l[m+a]]]*3;_*=_,j=_*_*(I[E]*n+I[E+1]*h+I[E+2]*f)}let B=.6-d*d-p*p-x*x;if(B<0)R=0;else{const E=M[w+1+l[b+1+l[m+1]]]*3;B*=B,R=B*B*(I[E]*d+I[E+1]*p+I[E+2]*x)}return 32*(g+A+j+R)}noise4D(o,e,r,M){const l=this.perm;let g,A,j,R,Z;const Y=(o+e+r+M)*Xt,C=Math.floor(o+Y),G=Math.floor(e+Y),v=Math.floor(r+Y),t=Math.floor(M+Y),T=(C+G+v+t)*U,N=C-T,D=G-T,q=v-T,u=t-T,c=o-N,F=e-D,S=r-q,y=M-u;let X=0,a=0,s=0,P=0;c>F?X++:a++,c>S?X++:s++,c>y?X++:P++,F>S?a++:s++,F>y?a++:P++,S>y?s++:P++;const O=X>=3?1:0,n=a>=3?1:0,h=s>=3?1:0,f=P>=3?1:0,d=X>=2?1:0,p=a>=2?1:0,x=s>=2?1:0,w=P>=2?1:0,b=X>=1?1:0,m=a>=1?1:0,V=s>=1?1:0,H=P>=1?1:0,_=c-O+U,B=F-n+U,E=S-h+U,rt=y-f+U,lt=c-d+2*U,at=F-p+2*U,ft=S-x+2*U,dt=y-w+2*U,ut=c-b+3*U,ht=F-m+3*U,mt=S-V+3*U,yt=y-H+3*U,gt=c-1+4*U,pt=F-1+4*U,Mt=S-1+4*U,wt=y-1+4*U,K=C&255,L=G&255,Q=v&255,$=t&255;let tt=.6-c*c-F*F-S*S-y*y;if(tt<0)g=0;else{const k=l[K+l[L+l[Q+l[$]]]]%32*4;tt*=tt,g=tt*tt*(z[k]*c+z[k+1]*F+z[k+2]*S+z[k+3]*y)}let nt=.6-_*_-B*B-E*E-rt*rt;if(nt<0)A=0;else{const k=l[K+O+l[L+n+l[Q+h+l[$+f]]]]%32*4;nt*=nt,A=nt*nt*(z[k]*_+z[k+1]*B+z[k+2]*E+z[k+3]*rt)}let ot=.6-lt*lt-at*at-ft*ft-dt*dt;if(ot<0)j=0;else{const k=l[K+d+l[L+p+l[Q+x+l[$+w]]]]%32*4;ot*=ot,j=ot*ot*(z[k]*lt+z[k+1]*at+z[k+2]*ft+z[k+3]*dt)}let st=.6-ut*ut-ht*ht-mt*mt-yt*yt;if(st<0)R=0;else{const k=l[K+b+l[L+m+l[Q+V+l[$+H]]]]%32*4;st*=st,R=st*st*(z[k]*ut+z[k+1]*ht+z[k+2]*mt+z[k+3]*yt)}let it=.6-gt*gt-pt*pt-Mt*Mt-wt*wt;if(it<0)Z=0;else{const k=l[K+1+l[L+1+l[Q+1+l[$+1]]]]%32*4;it*=it,Z=it*it*(z[k]*gt+z[k+1]*pt+z[k+2]*Mt+z[k+3]*wt)}return 27*(g+A+j+R+Z)}}function kt(i){const o=new Uint8Array(256);for(let e=0;e<256;e++)o[e]=e;for(let e=0;e<255;e++){const r=e+~~(i()*(256-e)),M=o[e];o[e]=o[r],o[r]=M}return o}function vt(i){let o=0,e=0,r=0,M=1;const l=Zt();return o=l(" "),e=l(" "),r=l(" "),o-=l(i),o<0&&(o+=1),e-=l(i),e<0&&(e+=1),r-=l(i),r<0&&(r+=1),function(){const g=2091639*o+M*23283064365386963e-26;return o=e,e=r,r=g-(M=g|0)}}function Zt(){let i=4022871197;return function(o){o=o.toString();for(let e=0;e<o.length;e++){i+=o.charCodeAt(e);let r=.02519603282416938*i;i=r>>>0,r-=i,r*=i,i=r>>>0,r-=i,i+=r*4294967296}return(i>>>0)*23283064365386963e-26}}var ct=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var i=0,o=arguments.length;o--;)i+=arguments[o]*arguments[o];return Math.sqrt(i)});function At(){var i=new ct(3);return ct!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function et(i,o,e){var r=new ct(3);return r[0]=i,r[1]=o,r[2]=e,r}function jt(i,o){var e=o[0],r=o[1],M=o[2],l=e*e+r*r+M*M;return l>0&&(l=1/Math.sqrt(l)),i[0]=o[0]*l,i[1]=o[1]*l,i[2]=o[2]*l,i}function zt(i,o,e){var r=o[0],M=o[1],l=o[2],g=e[0],A=e[1],j=e[2];return i[0]=M*j-l*A,i[1]=l*g-r*j,i[2]=r*A-M*g,i}(function(){var i=At();return function(o,e,r,M,l,g){var A,j;for(e||(e=3),r||(r=0),M?j=Math.min(M*e+r,o.length):j=o.length,A=r;A<j;A+=e)i[0]=o[A],i[1]=o[A+1],i[2]=o[A+2],l(i,i,g),o[A]=i[0],o[A+1]=i[1],o[A+2]=i[2];return o}})();let bt=null;const qt=(i,o,e,r,M,l,g,A,j,R)=>{let Z=0,Y=l,C=1,G=0;for(let v=0;v<M;v++){const t=bt.noise2D(i*Y+R[v][0],o*Y+R[v][1]);Z+=t*C,G+=C,C*=r,Y*=e}return Z/=G,Z=Math.pow(Math.abs(Z),A)*Math.sign(Z),Z*=g,Z+=j,Z};onmessage=function(i){const o=i.data.id,e=i.data.size,r=i.data.x,M=i.data.z,l=i.data.seed,g=i.data.subdivisions,A=i.data.lacunarity,j=i.data.persistence,R=i.data.iterations,Z=i.data.baseFrequency,Y=i.data.baseAmplitude,C=i.data.power,G=i.data.elevationOffset,v=i.data.iterationsOffsets,t=g+1;bt=new xt(l);const T=new xt(l),N=new Float32Array((t+1)*(t+1)),D=new Float32Array(t*t);for(let n=0;n<t+1;n++){const h=r+(n/g-.5)*e;for(let f=0;f<t+1;f++){const d=M+(f/g-.5)*e,p=qt(h,d,A,j,R,Z,Y,C,G,v),x=f*(t+1)+n;if(N[x]=p,n<t&&f<t){const w=f*t+n;D[w]=p}}}const q=g*4+4,u=new Float32Array(t*t*3+q*3);for(let n=0;n<t;n++){const h=M+(n/g-.5)*e;for(let f=0;f<t;f++){const d=r+(f/g-.5)*e,p=D[n*t+f],x=(n*t+f)*3;u[x]=d,u[x+1]=p,u[x+2]=h}}const c=new Float32Array(t*t*3+q*3),F=-e/g,S=-e/g;for(let n=0;n<t;n++)for(let h=0;h<t;h++){const f=n*(t+1)+h,d=N[f],p=N[f+1],x=N[f+t+1],w=et(F,d-p,0),b=et(0,d-x,S),m=At();zt(m,b,w),jt(m,m);const V=(n*t+h)*3;c[V]=m[0],c[V+1]=m[1],c[V+2]=m[2]}const y=new Float32Array(t*t*2+q*2);for(let n=0;n<t;n++)for(let h=0;h<t;h++){const f=(n*t+h)*2;y[f]=h/(t-1),y[f+1]=n/(t-1)}const X=g*g,a=new(X<65535?Uint16Array:Uint32Array)(X*6+g*4*6*4);for(let n=0;n<g;n++)for(let h=0;h<g;h++){const f=g+1,d=n*f+h,p=n*f+(h+1),x=(n+1)*f+h,w=(n+1)*f+(h+1),b=(n*g+h)*6;a[b]=d,a[b+1]=w,a[b+2]=p,a[b+3]=w,a[b+4]=d,a[b+5]=x}let s=t*t,P=t*t;for(let n=0;n<t;n++){const f=0*t+n,d=f*3;if(u[s*3]=u[d+0],u[s*3+1]=u[d+1]-15,u[s*3+2]=u[d+2],c[s*3]=c[d+0],c[s*3+1]=c[d+1],c[s*3+2]=c[d+2],y[s*2]=0/(t-1),y[s*2+1]=n/(t-1),n<t-1){const p=f,x=f+1,w=s,b=s+1,m=P*6;a[m]=x,a[m+1]=b,a[m+2]=p,a[m+3]=w,a[m+4]=p,a[m+5]=b,P++}s++}for(let n=0;n<t;n++){const h=t-1,f=h*t+n,d=f*3;if(u[s*3]=u[d+0],u[s*3+1]=u[d+1]-15,u[s*3+2]=u[d+2],c[s*3]=c[d+0],c[s*3+1]=c[d+1],c[s*3+2]=c[d+2],y[s*2]=h/(t-1),y[s*2+1]=n/(t-1),n<t-1){const p=f,x=f+1,w=s,b=s+1,m=P*6;a[m]=p,a[m+1]=w,a[m+2]=x,a[m+3]=b,a[m+4]=x,a[m+5]=w,P++}s++}for(let n=0;n<t;n++){const f=n*t+0,d=f*3;if(u[s*3]=u[d+0],u[s*3+1]=u[d+1]-15,u[s*3+2]=u[d+2],c[s*3]=c[d+0],c[s*3+1]=c[d+1],c[s*3+2]=c[d+2],y[s*2]=n/(t-1),y[s*2+1]=0,n<t-1){const p=f,x=f+t,w=s,b=s+1,m=P*6;a[m]=p,a[m+1]=w,a[m+2]=x,a[m+3]=b,a[m+4]=x,a[m+5]=w,P++}s++}for(let n=0;n<t;n++){const h=t-1,f=n*t+h,d=f*3;if(u[s*3]=u[d+0],u[s*3+1]=u[d+1]-15,u[s*3+2]=u[d+2],c[s*3]=c[d+0],c[s*3+1]=c[d+1],c[s*3+2]=c[d+2],y[s*2]=n/(t-1),y[s*2+1]=h/(t-1),n<t-1){const p=f,x=f+t,w=s,b=s+1,m=P*6;a[m]=x,a[m+1]=b,a[m+2]=p,a[m+3]=w,a[m+4]=p,a[m+5]=b,P++}s++}const O=new Float32Array(t*t*4);for(let n=0;n<t;n++)for(let h=0;h<t;h++){const f=(n*t+h)*3,d=et(u[f],u[f+1],u[f+2]),p=(n*t+h)*3,x=et(c[p],c[p+1],c[p+2]);Math.max(0,x[1]),d[1]>0&&T.noise2D(d[0]*.05+v[0][0],d[2]*.05+v[0][0]);const w=(n*t+h)*4;O[w]=c[p],O[w+1]=c[p+1],O[w+2]=c[p+2],O[w+3]=d[1]}postMessage({id:o,positions:u,normals:c,indices:a,texture:O,uv:y})}})();
